/*!
 * Guardian v0.2.0
 * Data guard and validation library
 * Copyright 2024 Serhii Pimenov
 * Licensed under MIT
 *
 * Build time: 21.07.2024 20:13:01
 */
var G=function(r){"use strict";class GuardianError extends Error{constructor(r="",e=null,n){super(r),this.message=r,this.name=e,this.value=n}}const parse=(r,e)=>{let n;if(!r)throw new Error("Schema object required for parse data!");if("function"==typeof r){if(n=r.apply(null,[e]),n instanceof GuardianError)throw n}else for(let t in r){const a=e[t],i=r[t];if(!i)throw new GuardianError(`Guard not defined for field ${t} in input data!`,"general",e);if(!e.hasOwnProperty(t))throw new GuardianError(`Field ${t} doesn't exists in input data!`,"general",e);if("function"==typeof i){if(console.log(i.name),n=i.apply(null,[a]),n instanceof GuardianError)throw n}else parse(i,a)}return e};var string=(r="VAL must be a string")=>function(e){const n=r.replace(/VAL/g,e);return"string"==typeof e?e:new GuardianError(n,"string",e)},isValue=r=>null!=r;const e="VAL must be an array of TYPE";const n="VAL must be a string or array with length N",t=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,a=/^[a-fA-F0-9]{1, 4}:[a-fA-F0-9]{1, 4}:[a-fA-F0-9]{1, 4}:[a-fA-F0-9]{1, 4}:[a-fA-F0-9]{1, 4}:[a-fA-F0-9]{1, 4}:[a-fA-F0-9]{1, 4}:[a-fA-F0-9]{1, 4}$/,i=/^((xn--)?[a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/;const o=/^(?:(?:(?:https?|ftp|wss?):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u00a1-\uffff][a-z0-9\u00a1-\uffff_-]{0,62})?[a-z0-9\u00a1-\uffff]\.)+(?:[a-z\u00a1-\uffff]{2,}\.?))(?::\d{2,5})?(?:[/?#]\S*)?$/i;const u=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i;const s=/^4\d{12}(?:\d{3,6})?$/u,c=/^5[1-5]\d{2}|(?:222\d|22[3-9]\d|2[3-6]\d{2}|27[01]\d|2720)\d{12}$/u,d=/^3[47]\d{13}$/u,f=/^6(?:011|5\d{2})\d{12,15}$/u,l=/^3(?:0[0-5]|[68]\d)\d{11,13}$/u,A=/^(?:2131|1800|35\d{3})\d{11}$/u,p=/^(?:6[27]\d{14,17}|81\d{14,17})$/u,g="VAL must be a valid CC number (visa, mastercard, american express, discover, diners club, jcb, or union pay)",card=(r,e,n=g)=>function(t){const a=n.replace(/VAL/g,t);return"string"==typeof t&&e.test(t)?t:new GuardianError(a,r,t)};return r.americanExpress=(r="VAL must be a valid American Express card number")=>card("american express",d,r),r.array=(r,n=e)=>(r||n||(r=string(),n=e),"string"==typeof r&&(n=r,r=string()),function(e){const t=n.replace(/VAL/g,e).replace(/TYPE/g,r.name);if(!Array.isArray(e))return new GuardianError(t,"array",e);for(let n of e){if(r(n)instanceof GuardianError)return new GuardianError(t,"array",e)}return e}),r.base64=(r="VAL must be a string in valid base 64 format")=>function(e){const n=r.replace(/VAL/g,e);return"string"==typeof e&&/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/.test(e)?e:new GuardianError(n,"base64",e)},r.between=(r,e,n="VAL must be between MIN_VAL and MAX_VAL")=>{if(!isValue(r))throw new Error("MIN_VALUE not defined!");if(!isValue(e))throw new Error("MAX_VALUE not defined!");return function(t){const a=n.replace(/VAL/g,t).replace(/MIN_VAL/g,r).replace(/MAX_VAL/g,e);return!isNaN(+t)&&t>=+r&&t<=+e?t:new GuardianError(a,"between",t)}},r.bigint=(r="VAL must be a bigint")=>function(e){const n=r.replace(/VAL/g,e);return"bigint"==typeof e?e:new GuardianError(n,"bigint",e)},r.boolean=(r="VAL must be a boolean")=>function(e){const n=r.replace(/VAL/g,e);return"boolean"==typeof e?e:new GuardianError(n,"boolean",e)},r.bytes=(r,e="The length of string must be VAL bytes")=>function(n){const t=e.replace(/VAL/g,n);return"string"==typeof n&&(new TextEncoder).encode(n).length===r?n:new GuardianError(t,"bytes",n)},r.compose=(...r)=>e=>r.reduceRight(((r,e)=>e(r)),e),r.creditCard=(r=g)=>function(e){const n=r.replace(/VAL/g,e);return"string"==typeof e&&(s.test(e)||c.test(e)||d.test(e)||f.test(e)||l.test(e)||A.test(e)||p.test(e))?e:new GuardianError(n,"creditCard",e)},r.date=(r="VAL must be valid date object or date string")=>function(e){const n=r.replace(/VAL/g,e);return e instanceof Date?e:new GuardianError(n,"date",e)},r.diners=(r="VAL must be a valid DINERS CLUB card number")=>card("diners club",l,r),r.discover=(r="VAL must be a valid DISCOVER card number")=>card("discover",f,r),r.domain=(r="VAL must be a valid domain name, xn--* for internationalized names")=>function(e){const n=r.replace(/VAL/g,e);return"string"==typeof e&&i.test(e)?e:new GuardianError(n,"domain",e)},r.email=(r="VAL must be a string in valid email format")=>function(e){const n=r.replace(/VAL/g,e);return"string"==typeof e&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?e:new GuardianError(n,"email",e)},r.endsWith=(r,e="VAL must end with END_VAL")=>{if(!isValue(r))throw new Error("END_VALUE not defined!");return function(n){const t=e.replace(/VAL/g,n).replace(/END_VAL/g,r);return"string"==typeof n&&n.endsWith(r)?n:new GuardianError(t,"endsWith",n)}},r.finite=(r="VAL must be a finite number")=>function(e){const n=r.replace(/VAL/g,e);return Number.isFinite(e)?e:new GuardianError(n,"finite",e)},r.func=(r="The value must be a function")=>function(e){return"function"==typeof e?e:new GuardianError(r,"function",e)},r.hexColor=(r="VAL must be a valid hex color")=>function(e){const n=r.replace(/VAL/g,e);return"string"==typeof e&&u.test(e)?e:new GuardianError(n,"hexColor",e)},r.imei=(r="VAL must be a valid EMEI")=>function(e){const n=r.replace(/VAL/g,e);return(r=>{const sumDig=r=>{let e=0;for(;r>0;)e+=r%10,r=parseInt(""+r/10,10);return e};let e=(""+r).length;if(15!==e)return!1;let n=0;for(let t=e;t>=1;t--){let e=r%10;t%2==0&&(e*=2),n+=sumDig(e),r=parseInt(""+r/10,10)}return n%10==0})(e)?e:new GuardianError(n,"emei",e)},r.info=()=>{console.info("%c GUARDIAN %c v0.2.0 %c 21.07.2024, 20:13:01 ","color: pink; font-weight: bold; background: #2b1700","color: white; background: darkgreen","color: white; background: #0080fe;")},r.integer=(r="VAL must be an integer")=>function(e){const n=r.replace(/VAL/g,e);return Number.isInteger(e)?e:new GuardianError(n,"integer",e)},r.ip=(r="VAL must be a valid ip address ipv4 or ipv6")=>function(e){const n=r.replace(/VAL/g,e);return"string"==typeof e&&(t.test(e)||a.test(e))?e:new GuardianError(n,"ip",e)},r.ipv4=(r="VAL must be a valid ipv4 address")=>function(e){const n=r.replace(/VAL/g,e);return"string"==typeof e&&t.test(e)?e:new GuardianError(n,"ipv4",e)},r.ipv6=(r="VAL must be a valid ipv6 address")=>function(e){const n=r.replace(/VAL/g,e);return"string"==typeof e&&a.test(e)?e:new GuardianError(n,"ipv6",e)},r.jcb=(r="VAL must be a valid JCB card number")=>card("jcb card",A,r),r.length=(r,e=n)=>function(n){const t=e.replace(/VAL/g,n).replace(/N/g,r);return("string"==typeof n||Array.isArray(n))&&n.length===r?n:new GuardianError(t,"length",n)},r.mastercard=(r="VAL must be a valid Mastercard card number")=>card("mastercard",c,r),r.maxLength=(r,e=n)=>function(n){const t=e.replace(/VAL/g,n).replace(/N/g,r);return("string"==typeof n||Array.isArray(n))&&n.length<=r?n:new GuardianError(t,"maxLength",n)},r.maxValue=(r,e="VAL must be a less then MAX_VALUE")=>{if(!isValue(r))throw new Error("MAX_VALUE not defined!");return function(n){const t=e.replace(/VAL/g,n).replace(/MAX_VALUE/g,r),a=+n;return!isNaN(a)&&a<=+r?n:new GuardianError(t,"maxValue",n)}},r.minLength=(r,e=n)=>function(n){const t=e.replace(/VAL/g,n).replace(/N/g,r);return("string"==typeof n||Array.isArray(n))&&n.length>=r?n:new GuardianError(t,"minLength",n)},r.minValue=(r,e="VAL must be a great then MIN_VALUE")=>{if(!isValue(r))throw new Error("MIN_VALUE not defined!");return function(n){const t=e.replace(/VAL/g,n).replace(/MIN_VALUE/g,r),a=+n;return!isNaN(a)&&a>=+r?n:new GuardianError(t,"minValue",n)}},r.notNull=(r="VAL can`t be null or undefined.")=>function(e){const n=r.replace(/VAL/g,e);return isValue(e)?e:new GuardianError(n,"notNull",e)},r.notNumber=(r="VAL can`t be a number")=>function(e){const n=r.replace(/VAL/g,e);return isNaN(e)?e:new GuardianError(n,"notNumber",e)},r.number=(r="VAL must be a number")=>function(e){const n=r.replace(/VAL/g,e);//!isNaN(input)
return"number"==typeof e?e:new GuardianError(n,"number",e)},r.object=(r="VAL must be an object")=>function(e){const n=r.replace(/VAL/g,e);return"object"==typeof e?{...e}:new GuardianError(n,"string",e)},r.parse=parse,r.pipe=(...r)=>e=>r.reduce(((r,e)=>e(r)),e),r.required=(r="Any value required")=>function(e){const n=r.replace(/VAL/g,e);return null!=e&&e?e:new GuardianError(n,"required",e)},r.safeInteger=(r="VAL must be an safe integer")=>function(e){const n=r.replace(/VAL/g,e);return Number.isSafeInteger(e)?e:new GuardianError(n,"safeInteger",e)},r.safeParse=(r,e)=>{let n;if(!r)throw new Error("Schema object required for parse data!");if("function"==typeof r){if(n=r.apply(null,[e]),n instanceof GuardianError)return{ok:!1,error:n}}else for(let t in r){const a=e[t],i=r[t];if(i)if("function"==typeof i){if(n=i.apply(null,[e]),n instanceof GuardianError)return{ok:!1,error:n}}else parse(i,a)}return{ok:!0,output:e}},r.startsWith=(r,e="VAL must starts with START_VAL")=>{if(!isValue(r))throw new Error("START_VALUE not defined!");return function(n){const t=e.replace(/VAL/g,n).replace(/START_VAL/g,r);return"string"==typeof n&&n.startsWith(r)?n:new GuardianError(t,"startsWith",n)}},r.string=string,r.symbol=(r="A symbol is required")=>function(e){return"symbol"==typeof e?e:new GuardianError(r,"symbol",e)},r.unionPay=(r="VAL must be a valid Union Pay card number")=>card("union pay",p,r),r.unknown=()=>function(r){return r},r.url=(r="VAL must be a valid url")=>function(e){const n=r.replace(/VAL/g,e);return"string"==typeof e&&o.test(e)?e:new GuardianError(n,"url",e)},r.visa=(r="VAL must be a valid Visa card number")=>card("visa",s,r),r}({});
